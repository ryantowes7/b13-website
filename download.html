<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Download - B13 Factory</title>
  <meta name="description" content="Download katalog produk, price list, brosur promosi, dan materi dari B13 Factory.">
  <meta property="og:title" content="Download - B13 Factory">
  <meta property="og:description" content="Katalog produk, price list, brosur, dan file promosi terbaru dari B13 Factory.">
  <meta property="og:image" content="/assets/uploads/og-download.jpg">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <nav>
        <div class="logo">
          <h1>B13 FACTORY</h1>
          <span>Garment & Advertising</span>
        </div>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="product.html">Product</a></li>
          <li><a href="article.html">Article</a></li>
          <li><a href="download.html" class="active">Download</a></li>
          <li><a href="about.html">About</a></li>
        </ul>
        <div class="search-box">
          <input type="text" id="search-download" placeholder="Cari file...">
        </div>
        <div class="menu-toggle">
          <span></span><span></span><span></span>
        </div>
      </nav>
    </div>
  </header>

  <main class="container" style="margin-top: 120px;">
    <div class="section-title">
      <h2>Download</h2>
      <p>Unduh katalog, price list, brosur, dan file promosi terbaru</p>
    </div>

    <!-- Filter Kategori -->
    <div class="category-filter" id="category-filter"></div>

    <!-- Daftar File -->
    <div id="downloads-list" class="downloads-grid"></div>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; <span id="year"></span> B13 Factory Garment & Advertising</p>
    <p>www.b13factory.com</p>
    <div class="social" id="social-links"></div>
  </footer>

  <script src="js/script.js"></script>
  <script>
    async function loadDownloads() {
      try {
        const res = await fetch("/content/downloads/index.json");
        const data = await res.json();

        // Ambil kategori unik
        const categories = ["all", ...new Set(data.map(d => d.category))];

        // Filter kategori
        const filter = document.getElementById("category-filter");
        filter.innerHTML = categories.map((c, i) => `
          <button class="filter-btn ${i===0?'active':''}" data-cat="${c}">${c==="all"?"Semua":c}</button>
        `).join("");

        // Render file download
        const container = document.getElementById("downloads-list");
        function renderDownloads(cat="all", search="") {
          let files = data;
          if (cat!=="all") files = files.filter(d => d.category === cat);
          if (search) files = files.filter(d => d.title.toLowerCase().includes(search.toLowerCase()));

          container.innerHTML = files.map(d => `
            <div class="download-card">
              <i class="fas fa-file-download file-icon"></i>
              <div class="download-info">
                <h3>${d.title}</h3>
                <p>${d.description}</p>
                <small><i class="far fa-calendar"></i> ${d.date} | <i class="fas fa-database"></i> ${d.size}</small>
                <br>
                <a href="${d.file}" class="download-btn" download>Download</a>
              </div>
            </div>
          `).join("");
        }
        renderDownloads();

        // Event kategori
        document.querySelectorAll(".filter-btn").forEach(btn => {
          btn.addEventListener("click", () => {
            document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");
            renderDownloads(btn.dataset.cat, document.getElementById("search-download").value);
          });
        });

        // Event search
        document.getElementById("search-download").addEventListener("input", (e) => {
          const activeCat = document.querySelector(".filter-btn.active").dataset.cat;
          renderDownloads(activeCat, e.target.value);
        });

        // Tahun otomatis
        document.getElementById("year").textContent = new Date().getFullYear();

        // Social dari home.json
        const socialRes = await fetch("/content/home.json");
        const homeData = await socialRes.json();
        const social = document.getElementById("social-links");
        social.innerHTML = homeData.social.map(s => `<a href="${s.url}" target="_blank"><i class="${s.icon}"></i></a>`).join("");

      } catch (err) {
        console.error("Gagal load downloads:", err);
      }
    }
    loadDownloads();
  </script>
</body>
</html>
