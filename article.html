<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artikel & Tips - B13 Factory</title>
  <meta name="description" content="Artikel terbaru seputar garment, digital printing, dan tips produk dari B13 Factory.">
  <meta property="og:title" content="Artikel & Tips - B13 Factory">
  <meta property="og:description" content="Baca artikel terbaru seputar garment, digital printing, desain, promosi, dan tips produk.">
  <meta property="og:image" content="/assets/uploads/og-article.jpg">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <nav>
        <div class="logo">
          <h1>B13 FACTORY</h1>
          <span>Garment & Advertising</span>
        </div>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="product.html">Product</a></li>
          <li><a href="article.html" class="active">Article</a></li>
          <li><a href="download.html">Download</a></li>
          <li><a href="about.html">About</a></li>
        </ul>
        <div class="search-box">
          <input type="text" id="search-article" placeholder="Cari artikel...">
        </div>
        <div class="menu-toggle">
          <span></span><span></span><span></span>
        </div>
      </nav>
    </div>
  </header>

  <main class="container" style="margin-top: 120px;">
    <div class="section-title">
      <h2>Artikel & Tips</h2>
      <p>Informasi terbaru seputar garment, digital printing, dan tips pemilihan produk</p>
    </div>

    <div class="articles-container">
      <div class="articles-list" id="articles-list"></div>
      <aside class="categories-sidebar">
        <h3>Kategori Artikel</h3>
        <ul class="category-list" id="category-list"></ul>
      </aside>
    </div>

    <!-- Pagination -->
    <div class="pagination" id="pagination"></div>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; <span id="year"></span> B13 Factory Garment & Advertising</p>
    <p>www.b13factory.com</p>
    <div class="social" id="social-links"></div>
  </footer>

  <script src="js/script.js"></script>
  <script>
    async function loadArticles() {
      try {
        const res = await fetch("/content/articles/index.json");
        const articles = await res.json();

        // === Variabel ===
        let currentPage = 1;
        const perPage = 5;

        const container = document.getElementById("articles-list");
        const pagination = document.getElementById("pagination");
        const categoryList = document.getElementById("category-list");
        const searchInput = document.getElementById("search-article");

        // === Ambil semua kategori unik ===
        const categories = [...new Set(articles.map(a => a.category))];
        categoryList.innerHTML = categories.map(c => `
          <li><a href="#" data-cat="${c}"><i class="fas fa-chevron-right"></i> ${c}</a></li>
        `).join("");

        // === Render Artikel ===
        function renderArticles(page=1, cat="all", search="") {
          let filtered = articles;

          if (cat !== "all") {
            filtered = filtered.filter(a => a.category === cat);
          }
          if (search) {
            filtered = filtered.filter(a => a.title.toLowerCase().includes(search.toLowerCase()));
          }

          const start = (page-1)*perPage;
          const paginated = filtered.slice(start, start+perPage);

          container.innerHTML = paginated.map(a => `
            <article class="article-card">
              <div class="article-image" style="background-image:url('${a.image}')"></div>
              <div class="article-content">
                <div class="article-meta">
                  <span><i class="far fa-calendar"></i> ${a.date}</span>
                  <span><i class="far fa-user"></i> ${a.author}</span>
                  <span><i class="far fa-folder"></i> ${a.category}</span>
                </div>
                <h3>${a.title}</h3>
                <p>${a.excerpt}</p>
                <a href="${a.url}" class="read-more">Baca Selengkapnya <i class="fas fa-arrow-right"></i></a>
              </div>
            </article>
          `).join("");

          // === Pagination ===
          const totalPages = Math.ceil(filtered.length/perPage);
          pagination.innerHTML = Array.from({length: totalPages}, (_, i) => `
            <a href="#" class="${i+1===page?'active':''}" data-page="${i+1}">${i+1}</a>
          `).join("");
        }

        // Render awal
        renderArticles();

        // Event Pagination
        pagination.addEventListener("click", (e) => {
          if (e.target.tagName === "A") {
            e.preventDefault();
            currentPage = parseInt(e.target.dataset.page);
            renderArticles(currentPage);
          }
        });

        // Event Category Filter
        categoryList.addEventListener("click", (e) => {
          if (e.target.tagName === "A") {
            e.preventDefault();
            const cat = e.target.dataset.cat;
            renderArticles(1, cat, searchInput.value);
          }
        });

        // Event Search
        searchInput.addEventListener("input", () => {
          renderArticles(1, "all", searchInput.value);
        });

        // Tahun otomatis
        document.getElementById("year").textContent = new Date().getFullYear();

        // Social dari home.json
        const socialRes = await fetch("/content/home.json");
        const homeData = await socialRes.json();
        const social = document.getElementById("social-links");
        social.innerHTML = homeData.social.map(s => `<a href="${s.url}" target="_blank"><i class="${s.icon}"></i></a>`).join("");

      } catch (err) {
        console.error("Gagal load articles:", err);
      }
    }
    loadArticles();
  </script>
</body>
</html>
