<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Katalog Produk - B13 Factory</title>
  <meta name="description" content="Temukan berbagai produk garment & advertising berkualitas dari B13 Factory.">
  <meta property="og:title" content="Katalog Produk - B13 Factory">
  <meta property="og:description" content="Produk garment, kaos, jaket, hoodie, topi, aksesoris, dan digital printing berkualitas.">
  <meta property="og:image" content="/assets/uploads/og-product.jpg">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <nav>
        <div class="logo">
          <h1>B13 FACTORY</h1>
          <span>Garment & Advertising</span>
        </div>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="product.html" class="active">Product</a></li>
          <li><a href="article.html">Article</a></li>
          <li><a href="download.html">Download</a></li>
          <li><a href="about.html">About</a></li>
        </ul>
        <div class="search-box">
          <input type="text" id="search-product" placeholder="Cari produk...">
        </div>
        <div class="menu-toggle">
          <span></span><span></span><span></span>
        </div>
      </nav>
    </div>
  </header>

  <main class="container" style="margin-top: 120px;">
    <div class="section-title">
      <h2>Katalog Produk</h2>
      <p>Temukan berbagai produk garment dan advertising berkualitas</p>
    </div>

    <!-- Filter Kategori -->
    <div class="category-filter" id="category-filter"></div>

    <!-- Daftar Produk -->
    <div id="products-list" class="products-grid"></div>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; <span id="year"></span> B13 Factory Garment & Advertising</p>
    <p>www.b13factory.com</p>
    <div class="social" id="social-links"></div>
  </footer>

  <script src="js/script.js"></script>
  <script>
    async function loadProducts() {
      try {
        const res = await fetch("/content/products/index.json");
        const data = await res.json();

        // Ambil semua kategori unik
        const categories = ["all", ...new Set(data.map(p => p.category))];

        // Filter kategori
        const filter = document.getElementById("category-filter");
        filter.innerHTML = categories.map((c, i) => `
          <button class="filter-btn ${i===0?'active':''}" data-cat="${c}">${c==="all"?"Semua Produk":c}</button>
        `).join("");

        // Render produk
        const container = document.getElementById("products-list");
        function renderProducts(cat="all", search="") {
          let products = data;
          if (cat!=="all") products = products.filter(p => p.category === cat);
          if (search) products = products.filter(p => p.title.toLowerCase().includes(search.toLowerCase()));

          container.innerHTML = products.map(p => `
            <div class="product-card">
              ${p.badge ? `<div class="product-badge">${p.badge}</div>` : ""}
              <div class="product-image" style="background-image:url('${p.image}')"></div>
              <div class="product-info">
                <h3>${p.title}</h3>
                <p>${p.description}</p>
                <a href="#" class="add-to-cart">Pesan Sekarang</a>
              </div>
            </div>
          `).join("");
        }
        renderProducts();

        // Event filter
        document.querySelectorAll(".filter-btn").forEach(btn => {
          btn.addEventListener("click", () => {
            document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");
            renderProducts(btn.dataset.cat, document.getElementById("search-product").value);
          });
        });

        // Event search
        document.getElementById("search-product").addEventListener("input", (e) => {
          const activeCat = document.querySelector(".filter-btn.active").dataset.cat;
          renderProducts(activeCat, e.target.value);
        });

        // Tahun otomatis
        document.getElementById("year").textContent = new Date().getFullYear();

        // Social links dari homepage data
        const socialRes = await fetch("/content/home.json");
        const homeData = await socialRes.json();
        const social = document.getElementById("social-links");
        social.innerHTML = homeData.social.map(s => `<a href="${s.url}" target="_blank"><i class="${s.icon}"></i></a>`).join("");

      } catch (err) {
        console.error("Gagal load products:", err);
      }
    }
    loadProducts();
  </script>
</body>
</html>
